<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>المنتجات | NEW MOON</title>

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* ====== تصميم احترافي فخم ====== */

        .products-hero {
            background-image:url('assets/images/products_hero.webp');
            background-size:cover;
            background-position:center;
            padding:120px 0;
            position:relative;
            color:#fff;
            text-align:center;
        }

        .products-hero .overlay {
            position:absolute;
            inset:0;
            background:rgba(0,0,0,0.55);
        }

        .products-hero .hero-content {
            position:relative;
            z-index:2;
        }

        /* Filters */
        .filters {
            display:flex;
            gap:15px;
            flex-wrap:wrap;
            margin-bottom:20px;
        }

        .filters input, .filters select {
            padding:12px 16px;
            border-radius:8px;
            border:1px solid #ddd;
            font-size:16px;
            flex:1;
            min-width:200px;
        }

        .filters button {
            padding:12px 22px;
            background:var(--gold);
            border:none;
            border-radius:8px;
            cursor:pointer;
            font-weight:bold;
            color:#081226;
        }

        /* Products Grid */
        .products-grid {
            display:grid;
            grid-template-columns:repeat(auto-fill, minmax(250px, 1fr));
            gap:22px;
            margin-top:25px;
        }

        .product-card {
            background:#fff;
            border-radius:14px;
            overflow:hidden;
            box-shadow:0 6px 20px rgba(0,0,0,0.12);
            transition:0.25s;
        }

        .product-card:hover {
            transform:translateY(-6px);
            box-shadow:0 10px 25px rgba(0,0,0,0.18);
        }

        .product-card img {
            width:100%;
            height:220px;
            object-fit:cover;
        }

        .product-info {
            padding:15px 18px;
        }

        .product-info h3 {
            margin:0 0 10px 0;
            font-size:18px;
            font-weight:700;
        }

        .product-info p {
            font-size:14px;
            opacity:0.8;
        }

        .details-btn {
            margin-top:12px;
            display:inline-block;
            padding:10px 16px;
            border:1px solid var(--gold);
            border-radius:6px;
            color:var(--gold);
            font-weight:600;
            transition:0.2s;
        }

        .details-btn:hover {
            background:var(--gold);
            color:#081226;
        }

        /* Pagination */
        .pagination {
            margin-top:35px;
            text-align:center;
        }

        .pagination button {
            padding:10px 16px;
            margin:4px;
            border:none;
            background:#ddd;
            border-radius:6px;
            cursor:pointer;
        }

        .pagination .active {
            background:var(--gold);
            color:#081226;
            font-weight:bold;
        }
    </style>
</head>

<body>

<!-- NAV INCLUDE -->
<div id="navbar"></div>
<script>
fetch("nav.html")
  .then(res => res.text())
  .then(data => document.getElementById("navbar").innerHTML = data);
</script>

<!-- HERO SECTION -->
<section class="products-hero">
    <div class="overlay"></div>
    <div class="container hero-content">
        <h1>كتالوج المنتجات</h1>
        <p>اختار من بين مجموعة منتجات NEW MOON المتنوعة.</p>
    </div>
</section>

<!-- FILTERS + PRODUCTS -->
<section class="section">
    <div class="container">

        <!-- FILTERS -->
        <div class="filters">
            <input type="text" id="searchBox" placeholder="ابحث عن منتج…">

            <select id="categoryFilter">
                <option value="">كل الأقسام</option>
                <option value="gifts">هدايا دعائية</option>
                <option value="uniform">يونيفورم</option>
                <option value="exhibition">تجهيزات معارض</option>
                <option value="uv">طباعة UV</option>
                <option value="office">توريدات مكتبية</option>
            </select>

            <button onclick="applyFilters()">تطبيق الفلاتر</button>
        </div>

        <!-- RESULTS COUNT -->
        <p id="resultsCount">عدد النتائج: ...</p>

        <!-- PRODUCTS -->
        <div id="productsContainer" class="products-grid"></div>

        <!-- PAGINATION -->
        <div id="pagination" class="pagination"></div>

    </div>
</section>

<!-- FOOTER INCLUDE -->
<div id="footer"></div>
<script>
fetch("footer.html")
  .then(res => res.text())
  .then(data => document.getElementById("footer").innerHTML = data);
</script>

<!-- JS: PRODUCT LOADER -->
<script>
let products = [];
let filtered = [];
let itemsPerPage = 12;
let currentPage = 1;

function loadProducts() {
    fetch("products.json")
        .then(res => res.json())
        .then(data => {
            products = data;
            filtered = products;
            renderProducts();
            renderPagination();
        });
}

function applyFilters() {
    const search = document.getElementById("searchBox").value.trim().toLowerCase();
    const category = document.getElementById("categoryFilter").value;

    filtered = products.filter(p => {
        const matchSearch =
            p.name.toLowerCase().includes(search) ||
            p.desc.toLowerCase().includes(search);

        const matchCat = category ? p.category === category : true;

        return matchSearch && matchCat;
    });

    currentPage = 1;
    renderProducts();
    renderPagination();
}

function renderProducts() {
    const box = document.getElementById("productsContainer");
    box.innerHTML = "";

    document.getElementById("resultsCount").innerText =
        "عدد النتائج: " + filtered.length;

    const start = (currentPage - 1) * itemsPerPage;
    const pageItems = filtered.slice(start, start + itemsPerPage);

    pageItems.forEach(p => {
        box.innerHTML += `
            <div class="product-card">
                <img src="${p.img}" alt="${p.name}">
                <div class="product-info">
                    <h3>${p.name}</h3>
                    <p>${p.desc}</p>
                    <a class="details-btn" href="product.html?id=${p.id}">
                        تفاصيل المنتج
                    </a>
                </div>
            </div>
        `;
    });
}

function renderPagination() {
    const total = filtered.length;
    const pages = Math.ceil(total / itemsPerPage);

    const pag = document.getElementById("pagination");
    pag.innerHTML = "";

    for (let i = 1; i <= pages; i++) {
        pag.innerHTML += `
            <button class="${i === currentPage ? 'active' : ''}"
                onclick="goToPage(${i})">${i}</button>
        `;
    }
}

function goToPage(num) {
    currentPage = num;
    renderProducts();
    renderPagination();
}

loadProducts();
</script>

</body>
</html>
